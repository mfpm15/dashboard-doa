import React, { useState, useEffect, useMemo, useRef } from 'react';

// -- CATATAN PWA (PROGRESSIVE WEB APP) --
// Untuk menjadikan aplikasi ini PWA sepenuhnya, beberapa langkah perlu dibuat pada fail index.html utama anda (di luar komponen React ini):
// 1. Buat fail `manifest.json` untuk mentakrifkan ikon aplikasi, warna, dsb.
// 2. Tambah `<link rel="manifest" href="/manifest.json">` dalam `<head>` fail HTML anda.
// 3. Tambah `<meta name="theme-color" content="#14b8a6">` dalam `<head>`.
// 4. Buat fail `service-worker.js` untuk menguruskan caching dan fungsian luar talian.
// 5. Daftar service worker dengan menambah skrip berikut sebelum penutup tag `</body>`:
/*
   if ('serviceWorker' in navigator) {
     window.addEventListener('load', () => {
       navigator.serviceWorker.register('/service-worker.js')
         .then(registration => console.log('Service Worker terdaftar: ', registration))
         .catch(err => console.log('Pendaftaran Service Worker gagal: ', err));
     });
   }
*/

// -- DATA DOA AWAL --
const initialPrayerData = [
    { "id": 1, "title": "Istighfar & Doa Keselamatan (Pembuka Zikir)", "category": "Zikir Setelah Shalat", "kaidah": "Amalan pertama setelah salam: istighfar tiga kali lalu memuji Allah sebagai As-Salām.", "arabic": "أَسْتَغْفِرُ اللَّهَ (٣x)\n\nاللَّهُمَّ أَنْتَ السَّلَامُ، وَمِنْكَ السَّلَامُ، تَبَارَكْتَ يَا ذَا الْجَلَالِ وَالْإِكْرَامِ.", "latin": "Astaghfirullāh (3x). Allāhumma anta as-salām, wa minka as-salām, tabārakta yā dzal-jalāli wal-ikrām.", "translation": "\"Aku memohon ampun kepada Allah\" (3x). \"Ya Allah, Engkau Mahasejahtera, dan dari-Mu segala kesejahteraan. Mahaberkah Engkau, wahai Pemilik keagungan dan kemuliaan.\"", "source": "HR Muslim." },
    { "id": 2, "title": "Tasbih, Tahmid, Takbir (33x) & Tahlil", "category": "Zikir Setelah Shalat", "kaidah": "Zikir ringan berpahala besar setelah shalat fardhu.", "arabic": "سُبْحَانَ اللَّهِ (٣٣x) اَلْحَمْدُ لِلَّهِ (٣٣x) اللَّهُ أَكْبَرُ (٣٣x)\n\nلَا إِلَهَ إِلَّا اللَّهُ وَحْدَهُ لَا شَرِيكَ لَهُ، لَهُ الْمُلْkُ وَلَهُ الْحَمْدُ، وَهُوَ عَلَى كُلِّ شَيْءٍ قَدِيرٌ", "latin": "Subḥānallāh (33x), al-ḥamdu lillāh (33x), Allāhu akbar (33x). Lā ilāha illallāhu waḥdahū lā syarīka lah, lahul-mulku wa lahul-ḥamdu, wa huwa ‘alā kulli syay’in qadīr (1x).", "translation": "Mahasuci Allah (33x), segala puji bagi Allah (33x), Allah Mahabesar (33x). Tiada sesembahan selain Allah Yang Esa, tiada sekutu bagi-Nya. Milik-Nya kerajaan dan pujian, dan Dia Mahakuasa atas segala sesuatu.", "source": "HR Muslim." },
    { "id": 3, "title": "Ayat Kursi", "category": "Zikir Setelah Shalat", "kaidah": "Ayat paling agung dalam Al-Qur'an, dibaca setelah shalat fardhu.", "arabic": "اللَّهُ لَا إِلَهَ إِلَّا هُوَ الْحَيُّ الْقَيُّومُ ۚ لَا تَأْخُذُهُ سِنَةٌ وَلَا نَوْمٌ ۚ لَهُ مَا فِي السَّمَاوَاتِ وَمَا فِي الْأَرْضِ ۗ مَنْ ذَا الَّذِي يَشْفَعُ عِنْدَهُ إِلَّا بِإِذْنِهِ ۚ يَعْلَمُ مَا بَيْنَ أَيْدِيهِمْ وَمَا خَلْفَهُمْ ۖ وَلَا يُحِيطُونَ بِشَيْءٍ مِنْ عِلْمِهِ إِلَّا بِمَا شَاءَ ۚ وَسِعَ كُرْسِيُّهُ السَّمَاوَاتِ وَالْأَرْضَ ۖ وَلَا يَئُودُهُ حِفْظُهُمَا ۚ وَهُوَ الْعَلِيُّ الْعَظِيمُ", "latin": "Allāhu lā ilāha illā huwal-ḥayyul-qayyūm, lā ta’khudzuhu sinatun wa lā nawm, lahu mā fis-samāwāti wa mā fil-arḍ, man dzal-ladzī yasyfa‘u ‘indahū illā bi-idznih, ya‘lamu mā baina aydīhim wa mā khalfahum, wa lā yuḥīṭūna bisyay’in min ‘ilmihī illā bimā syā’, wasi‘a kursiyyuhus-samāwāti wal-arḍ, wa lā ya’ūduhū ḥifẓuhumā, wa huwal-‘aliyyul-‘aẓīm.", "translation": "Allah, tiada tuhan selain Dia, Yang Mahahidup, Yang terus-menerus mengurus (makhluk-Nya). Tidak mengantuk dan tidak tidur. Milik-Nya apa yang di langit dan di bumi. Siapa yang dapat memberi syafaat di sisi-Nya tanpa izin-Nya? Dia mengetahui apa yang di hadapan mereka dan di belakang mereka, dan mereka tidak mengetahui sesuatu pun dari ilmu-Nya kecuali apa yang Dia kehendaki. Kursi-Nya meliputi langit dan bumi, dan Dia tidak merasa berat memelihara keduanya. Dia Mahatinggi lagi Mahabesar.", "source": "QS Al-Baqarah: 255." },
    { "id": 4, "title": "Al-Mu‘awwidzāt (Al-Ikhlāṣ, Al-Falaq, An-Nās)", "category": "Zikir Setelah Shalat", "kaidah": "Tiga surah perlindungan. Dibaca 1x setelah shalat; khusus Subuh & Maghrib dibaca 3x.", "arabic": "بِسْمِ اللَّهِ الرَّحْمَنِ الرَّحِيمِ. قُلْ هُوَ اللَّهُ أَحَدٌ ۝ اللَّهُ الصَّمَدُ ۝ لَمْ يَلِدْ وَلَمْ يُولَدْ ۝ وَلَمْ يَكُنْ لَهُ كُفُوًا أَحَدٌ.\n\nبِسْمِ اللَّهِ الرَّحْمَنِ الرَّحِيمِ. قُلْ أَعُوذُ بِرَبِّ الْفَلَقِ ۝ مِنْ شَرِّ مَا خَلَقَ ۝ وَمِنْ شَرِّ غَاسِقٍ إِذَا وَقَبَ ۝ وَمِنْ شَرِّ النَّفَّاثَاتِ فِي الْعُقَدِ ۝ وَمِنْ شَرِّ حَاسِدٍ إِذَا حَسَدَ.\n\nبِسْمِ اللَّهِ الرَّحْمَنِ الرَّحِيمِ. قُلْ أَعُوذُ بِرَبِّ النَّاسِ ۝ مَلِكِ النَّاسِ ۝ إِلَهِ النَّاسِ ۝ مِنْ شَرِّ الْوَسْوَاسِ الْخَنَّاسِ ۝ الَّذِي يُوَسْوِسُ فِي صُدُورِ النَّاسِ ۝ مِنَ الْجِنَّةِ وَالنَّاسِ.", "latin": "Bismillāhir-raḥmānir-raḥīm. Qul huwallāhu aḥad, allāhuṣ-ṣamad, lam yalid wa lam yūlad, wa lam yakun lahu kufuwan aḥad.\n\nBismillāhir-raḥmānir-raḥīm. Qul a‘ūdzu birabbil-falaq, min syarri mā khalaq, wa min syarri ghāsiqin idzā waqab, wa min syarrin-naffāṯāti fil-‘uqad, wa min syarri ḥāsidin idzā ḥasad.\n\nBismillāhir-raḥmānir-raḥīm. Qul a‘ūdzu birabbin-nās, malikin-nās, ilāhin-nās, min syarril-waswāsil-khannās, allażī yuwaswisu fī ṣudūrin-nās, minal-jinnati wan-nās.", "translation": "Dengan nama Allah Yang Maha Pengasih lagi Maha Penyayang. Katakanlah: Dialah Allah Yang Maha Esa... (Al-Ikhlas)\n\nDengan nama Allah Yang Maha Pengasih lagi Maha Penyayang. Katakanlah: Aku berlindung kepada Tuhan yang menguasai subuh... (Al-Falaq)\n\nDengan nama Allah Yang Maha Pengasih lagi Maha Penyayang. Katakanlah: Aku berlindung kepada Tuhan manusia... (An-Nas)", "source": "HR Abu Dawud, Tirmidzi, Nasa’i." },
    { "id": 5, "title": "Doa Wasiat Nabi kepada Mu‘ādz", "category": "Zikir Setelah Shalat", "kaidah": "Permohonan agar ditolong untuk zikir, syukur, dan ibadah terbaik. Penutup rangkaian zikir setelah shalat.", "arabic": "اللَّهُمَّ أَعِنِّي عَلَى ذِكْرِكَ وَشُكْرِكَ وَحُسْنِ عِبَادَتِكَ", "latin": "Allāhumma a‘innī ‘alā dzikrika wa syukrika wa ḥusni ‘ibādatik.", "translation": "Ya Allah, tolonglah aku untuk mengingat-Mu, bersyukur kepada-Mu, dan beribadah kepada-Mu dengan sebaik-baiknya.", "source": "HR Abu Dawud, an-Nasa’i (sahih)." },
    { "id": 6, "title": "Shalawat Ibrahimiyyah (Pembuka/Penutup Doa)", "category": "Pembukaan & Penutup Doa", "kaidah": "Adab berdoa adalah dibuka dan ditutup dengan shalawat. Ini adalah lafaz shalawat terbaik.", "arabic": "اللَّهُمَّ صَلِّّ عَلَىٰ مُحَمَّدٍ وَعَلَىٰ آلِ مُحَمَّدٍ كَمَا صَلَّيْتَ عَلَىٰ إِبْرَاهِيمَ وَعَلَىٰ آلِ إِبْرَاهِيمَ إِنَّكَ حَمِيدٌ مَجِيدٌ، اللَّهُمَّ بَارِكْ عَلَىٰ مُحَمَّدٍ وَعَلَىٰ آلِ مُحَمَّدٍ كَمَا بَارَكْتَ عَلَىٰ إِبْرَاهِيمَ وَعَلَىٰ آلِ إِبْرَahِيمَ إِنَّكَ حَمِيدٌ مَجِيدٌ", "latin": "Allāhumma ṣalli ‘alā Muḥammadin wa ‘alā āli Muḥammad, kamā ṣallayta ‘alā Ibrāhīma wa ‘alā āli Ibrāhīm, innaka Ḥamīdun Majīd. Allāhumma bārik ‘alā Muḥammadin wa ‘alā āli Muḥammad, kamā bārakta ‘alā Ibrāhīma wa ‘alā āli Ibrāhīm, innaka Ḥamīdun Majīd.", "translation": "Ya Allah, limpahkanlah salawat kepada Muhammad dan keluarga Muhammad sebagaimana Engkau telah melimpahkan kepada Ibrahim dan keluarga Ibrahim. Sungguh Engkau Maha Terpuji lagi Maha Mulia. Dan berkahilah Muhammad dan keluarga Muhammad sebagaimana Engkau telah memberkahi Ibrahim dan keluarga Ibrahim. Sungguh Engkau Maha Terpuji lagi Maha Mulia.", "source": "HR Bukhari & Muslim." },
    { "id": 7, "title": "Sayyidul Istighfar (Raja Istighfar)", "category": "Doa Pengampunan", "kaidah": "Istighfar paling sempurna; sangat baik untuk memulai permohonan ampun.", "arabic": "اللَّهُمَّ أَنْتَ رَبِّي لَا إِلَهَ إِلَّا أَنْتَ، خَلَقْتَنِي وَأَنَا عَبْدُكَ، وَأَنَا عَلَىٰ عَهْدِكَ وَوَعْدِكَ مَا اسْتَطَعْتُ، أَعُوذُ بِكَ مِنْ شَرِّ مَا صَنَعْتُ، أَبُوءُ لَكَ بِنِعْمَتِكَ عَلَيَّ، وَأَبُوءُ لَكَ بِذَنْبِي، فَاغْفِرْ لِي، فَإِنَّهُ لَا يَغْفِرُ الذُّنُوبَ إِلَّا أَنْتَ", "latin": "Allāhumma anta rabbī, lā ilāha illā anta, khalaqtanī wa anā ‘abduka, wa anā ‘alā ‘ahdika wa wa‘dika mastāṭa‘t, a‘ūdzu bika min syarri mā ṣana‘t, abū’u laka bini‘matika ‘alayya, wa abū’u laka bi dzanbī, faghfir lī, fa innahu lā yaghfiru dz-dzunūba illā ant.", "translation": "Ya Allah, Engkau Tuhanku; tiada sesembahan selain Engkau. Engkau telah menciptakanku dan aku adalah hamba-Mu. Aku berada di atas perjanjian dan janji-Mu semampuku. Aku berlindung kepada-Mu dari keburukan yang aku perbuat. Aku mengakui nikmat-Mu atasku, dan aku mengakui dosaku; maka ampunilah aku, karena sungguh tidak ada yang mengampuni dosa kecuali Engkau.", "source": "HR Bukhari." },
    { "id": 8, "title": "Doa Taubat Nabi Adam", "category": "Doa Pengampunan", "kaidah": "Doa pengakuan kesalahan pertama yang diajarkan Allah kepada Nabi Adam.", "arabic": "رَبَّنَا ظَلَمْنَا أَنْفُсَنَا وَإِنْ لَمْ تَغْفِرْ لَنَا وَتَرْحَمْنَا لَنَكُونَنَّ مِنَ الْخَاسِرِينَ", "latin": "Rabbanā ẓalamnā anfusanā, wa illam taghfir lanā wa tarḥamnā lanakūnanna minal-khāsirīn.", "translation": "Ya Tuhan kami, kami telah menzalimi diri kami sendiri; jika Engkau tidak mengampuni kami dan menyayangi kami, niscaya kami termasuk orang-orang yang merugi.", "source": "QS Al-A'raf: 23." },
    { "id": 9, "title": "Doa Nabi Yunus di Perut Ikan", "category": "Doa Pengampunan", "kaidah": "Doa untuk mengatasi kesempitan dan mengakui kesalahan.", "arabic": "لَا إِلَهَ إِلَّا أَنْتَ سُبْحَانَكَ إِنِّي كُنْتُ مِنَ الظَّالِمِينَ", "latin": "Lā ilāha illā anta, subḥānaka innī kuntu minaẓ-ẓālimīn.", "translation": "Tiada tuhan selain Engkau. Mahasuci Engkau. Sungguh aku termasuk orang-orang yang zalim.", "source": "QS Al-Anbiya': 87." },
    { "id": 10, "title": "Doa Pengakuan Dosa Nabi Musa", "category": "Doa Pengampunan", "kaidah": "Pengakuan salah secara langsung dan permohonan ampun.", "arabic": "رَبِّ إِنِّي ظَلَمْتُ نَفْسِي فَاغْفِرْ لِي", "latin": "Rabbi innī ẓalamtu nafsī faghfir lī.", "translation": "Ya Rabbku, sesungguhnya aku telah menzalimi diriku; maka ampunilah aku.", "source": "QS Al-Qasas: 16." },
    { "id": 11, "title": "Doa Penutup Al-Baqarah (Ampunan & Kekuatan)", "category": "Doa Pengampunan", "kaidah": "Dua ayat terakhir Al-Baqarah yang memiliki keutamaan besar, berisi permohonan ampun dan kekuatan.", "arabic": "آمَنَ الرَّسُولُ بِمَا أُنْزِلَ إِلَيْهِ مِنْ رَبِّهِ وَالْمُؤْمِنُونَ ۚ كُلٌّ آمَنَ بِاللَّهِ وَمَلَائِكَتِهِ وَكُتُبِهِ وَرُسُلِهِ لَا نُفَرِّقُ بَيْنَ أَحَدٍ مِنْ رُسُلِهِ ۚ وَقَالُوا سَمِعْنَا وَأَطَعْنَا ۖ غُفْرَانَكَ رَبَّنَا وَإِلَيْكَ الْمَصِيرُ. لَا يُكَلِّفُ اللَّهُ نَفْسًا إِلَّا وُسْعَهَا ۚ لَهَا مَا كَسَبَتْ وَعَلَيْهَا مَا اكْتَسَبَتْ ۗ رَبَّنَا لَا تُؤَاخِذْنَا إِنْ نَسِينَا أَوْ أَخْطَأْنَا ۚ رَبَّنَا وَلَا تَحْمِلْ عَلَيْنَا إِصْرًا كَمَا حَمَلْتَهُ عَلَى الَّذِينَ مِنْ قَبْلِنَا ۚ رَبَّنَا وَلَا تُحَمِّلْنَا مَا لَا طَاقَةَ لَنَا بِهِ ۖ وَاعْفُ عَنَّا وَاغْفِرْ لَنَا وَارْحَمْنَا ۚ أَنْتَ مَوْلَانَا فَانْصُرْنَا عَلَى الْقَوْمِ الْكَافِرِينَ.", "latin": "Āmanar-rasūlu bimā unzila ilaihi mir rabbihī wal-mu’minūn, kullun āmana billāhi wa malā’ikatihī wa kutubihī wa rusulih, lā nufarriqu baina aḥadim mir rusulih, wa qālụ sami'nā wa aṭa'nā ghufrānaka rabbanā wa ilaikal-maṣīr. Lā yukallifullāhu nafsan illā wus'ahā, lahā mā kasabat wa 'alaihā maktasabat, rabbanā lā tu`ākhidznā in nasīnā au akhṭa`nā, rabbanā wa lā taḥmil 'alainā iṣrang kamā ḥamaltahụ 'alallażīna ming qablinā, rabbanā wa lā tuḥammilnā mā lā ṭāqata lanā bih, wa'fu 'annā, waghfir lanā, war-ḥamnā, anta maulānā fanṣurnā 'alal-qaumil-kāfirīn.", "translation": "Rasul (Muhammad) beriman kepada apa yang diturunkan kepadanya (Al-Qur`an) dari Tuhannya, demikian pula orang-orang yang beriman. Semua beriman kepada Allah, malaikat-malaikat-Nya, kitab-kitab-Nya, dan rasul-rasul-Nya. (Mereka berkata), \"Kami tidak membeda-bedakan seorang pun dari rasul-rasul-Nya.\" Dan mereka berkata, \"Kami dengar dan kami taat. Ampunilah kami Ya Tuhan kami, dan kepada-Mu tempat (kami) kembali.\"\nAllah tidak membebani seseorang melainkan sesuai dengan kesanggupannya. Dia mendapat (pahala) dari kebajikan yang dikerjakannya dan dia mendapat (siksa) dari (kejahatan) yang diperbuatnya. (Mereka berdoa), \"Ya Tuhan kami, janganlah Engkau hukum kami jika kami lupa atau kami melakukan kesalahan. Ya Tuhan kami, janganlah Engkau bebani kami dengan beban yang berat sebagaimana Engkau bebankan kepada orang-orang sebelum kami. Ya Tuhan kami, janganlah Engkau pikulkan kepada kami apa yang tidak sanggup kami memikulnya. Maafkanlah kami, ampunilah kami, dan rahmatilah kami. Engkaulah pelindung kami, maka tolonglah kami menghadapi orang-orang kafir.\"", "source": "QS Al-Baqarah: 285-286." },
    { "id": 12, "title": "Taubat Total & Mohon Amal Saleh", "category": "Doa Pengampunan", "kaidah": "Minta ampunan masa lalu, penjagaan sisa umur, dan amal yang diridhai.", "arabic": "اللَّهُمَّ اغْفِرْ لِي جَمِيعَ مَا مَضَى مِنْ ذُنُوبِي، وَاعْصِمْنِي فِيمَا بَقِيَ مِنْ عُمْرِي، وَارْزُقْنِي عَمَلًا صَالِحًا تَرْضَى بِهِ عَنِّي", "latin": "Allāhumma ighfir lī jamī‘a mā maḍā min dzunūbī, wa‘ṣimnī fīmā baqiya min ‘umrī, warzuqnī ‘amalan ṣāliḥan tarḍā bihī ‘annī.", "translation": "Ya Allah, ampunilah seluruh dosa-dosaku yang telah berlalu, jagalah aku pada sisa umurku, dan anugerahkan kepadaku amal saleh yang dengan itu Engkau meridhai diriku.", "source": "Doa umum (ghairu ma’tsur)." },
    { "id": 13, "title": "Memohon Ketetapan Hati di Atas Agama", "category": "Doa Iman & Akhlak", "kaidah": "Hati di tangan Allah; minta diteguhkan di atas agama-Nya.", "arabic": "يَا مُقَلِّبَ الْقُلُوبِ، ثَبِّتْ قَلْبِي عَلَى دِينِكَ", "latin": "Yā Muqallibal-qulūb, ṯabbit qalbī ‘alā dīnik.", "translation": "Wahai Pembolak-balik hati, tetapkanlah hatiku di atas agama-Mu.", "source": "HR Tirmidzi (hasan)." },
    { "id": 14, "title": "Meneguhkan Hati di Atas Hidayah", "category": "Doa Iman & Akhlak", "kaidah": "Doa agar hati tidak berpaling setelah mendapat petunjuk.", "arabic": "رَبَّنَا لَا تُزِغْ قُلُوبَنَا bَعْدَ إِذْ هَدَيْتَنَا وَهَبْ لَنَا مِنْ لَدُنْكَ رَحْمَةً إِنَّكَ أَنْتَ الْوَهَّابُ", "latin": "Rabbanā lā tuzigh qulūbanā ba‘da idh hadaytanā wahab lanā min ladunka raḥmah, innaka antal-Wahhāb.", "translation": "Ya Tuhan kami, janganlah Engkau palingkan hati kami setelah Engkau beri petunjuk, dan karuniakan kepada kami rahmat dari sisi-Mu. Sungguh Engkaulah Maha Pemberi.", "source": "QS Ali ‘Imran: 8." },
    { "id": 15, "title": "Memohon Hidayah, Takwa, 'Iffah, dan Kecukupan", "category": "Doa Iman & Akhlak", "kaidah": "Empat permohonan inti untuk kualitas diri seorang muslim.", "arabic": "اللَّهُمَّ إِنِّي أَسْأَلُكَ الْهُدَى وَالتُّقَى وَالْعَفَافَ وَالْغِنَى", "latin": "Allāhumma innī as’aluka al-hudā wat-tuqā wal-‘afāfa wal-ghinā.", "translation": "Ya Allah, aku memohon kepada-Mu petunjuk, ketakwaan, kehormatan diri, dan kecukupan.", "source": "HR Muslim." },
    { "id": 16, "title": "Memohon Jiwa yang Bertakwa dan Disucikan", "category": "Doa Iman & Akhlak", "kaidah": "Permohonan agar Allah menganugerahkan ketakwaan pada jiwa dan menyucikannya.", "arabic": "اللَّهُمَّ آتِ نَفْسِي تَقْوَاهَا، وَزَكِّهَا أَنْتَ خَيْرُ مَنْ زَكَّاهَا، أَنْتَ وَلِيُّهَا وَمَوْلَاهَا", "latin": "Allāhumma āti nafsī taqwāhā, wa zakkihā anta khayru man zakkāhā, anta waliyyuhā wa mawlāhā.", "translation": "Ya Allah, berikanlah pada jiwaku ketakwaannya dan sucikanlah ia, Engkaulah sebaik-baik yang menyucikannya; Engkaulah pelindung dan penolongnya.", "source": "HR Muslim." },
    { "id": 17, "title": "Agar Hati Menyatu dengan Al-Qur’an", "category": "Doa Iman & Akhlak", "kaidah": "Agar Al-Qur’an jadi musim semi hati, cahaya dada, penghapus sedih & gelisah.", "arabic": "اللَّهُمَّ اجْعَلِ الْقُرْآنَ رَبِيعَ قَلْبِي، وَنُورَ صَدْرِي، وَجَلَاءَ حُزْنِي، وَذَهَابَ هَمِّي", "latin": "Allāhummaj‘alil-Qur’āna rabī‘a qalbī, wa nūra ṣadrī, wa jalā’a ḥuznī, wa żahāba hammī.", "translation": "Ya Allah, jadikanlah Al-Qur’an sebagai musim semi hatiku, cahaya dadaku, penghapus kesedihanku, dan pelenyap kegundahanku.", "source": "HR Aḥmad (sahih)." },
    { "id": 18, "title": "Pereda Amarah", "category": "Doa Iman & Akhlak", "kaidah": "Redakan emosi: minta ampun, tenang, dan lindungan dari setan.", "arabic": "اللَّهُمَّ اغْفِرْ لِي ذَنْبِي، وَأَذْهِبْ غَيْظَ قَلْبِي، وَأَجِرْنِي مِنَ الشَّيْطَانِ", "latin": "Allāhummaghfir lī dzanbī, wa adhhib ghaizha qalbī, wa ajirnī minasy-syayṭān.", "translation": "Ya Allah, ampunilah dosaku, lenyapkanlah amarah di hatiku, dan lindungilah aku dari setan.", "source": "Doa umum, makna sesuai sunnah." },
    { "id": 19, "title": "Doa Membersihkan Hati dari Dengki", "category": "Doa Iman & Akhlak", "kaidah": "Doa untuk para pendahulu beriman dan pemurnian hati.", "arabic": "رَبَّنَا اغْفِرْ لَنَا وَلِإِخْوَانِنَا الَّذِينَ سَبَقُونَا بِالْإِيمَانِ وَلَا تَجْعَلْ فِي قُلُوبِنَا غِلًّا لِلَّذِينَ آمَنُوا رَبَّنَا إِنَّكَ رَءُوفٌ رَحِيمٌ", "latin": "Rabbanaghfir lanā wa li-ikhwāninalladzīna sabaqūnā bil-īmān, wa lā taj‘al fī qulūbinā ghillal lilladzīna āmanū, rabbanā innaka ra’ūfur raḥīm.", "translation": "Ya Tuhan kami, ampunilah kami dan saudara-saudara kami yang telah lebih dahulu beriman, dan janganlah Engkau jadikan dalam hati kami kedengkian terhadap orang-orang beriman. Ya Tuhan kami, sungguh Engkau Maha Penyantun, Maha Penyayang.", "source": "QS Al-Hasyr: 10." },
    { "id": 20, "title": "Doa untuk Kedua Orang Tua", "category": "Doa Keluarga", "kaidah": "Permohonan ampunan dan kasih sayang untuk orang tua.", "arabic": "رَبِّ اغْفِرْ لِي وَلِوَالِدَيَّ وَارْحَمْهُمَا كَمَا رَبَّيَانِي صَغِيرًا.\nرَبَّنَا اغْفِرْ لِي وَلِوَالِدَيَّ وَلِلْمُؤْمِنِينَ يَوْمَ يَقُومُ الْحِسَابُ.", "latin": "Rabbighfir lī wa liwālidayya warḥamhumā kamā rabbayānī ṣaghīrā. Rabbanaghfir lī wa liwālidayya wa lil-mu’minīna yawma yaqūmul-ḥisāb.", "translation": "Ya Tuhanku, ampunilah aku dan kedua orang tuaku, dan sayangilah mereka sebagaimana mereka mendidikku di waktu kecil. Ya Tuhan kami, ampunilah aku, kedua orang tuaku, dan orang-orang beriman pada hari ditegakkannya perhitungan.", "source": "QS Al-Isra’:24 & QS Ibrahim:41." },
    { "id": 21, "title": "Doa untuk Pasangan & Keturunan Penyejuk Hati", "category": "Doa Keluarga", "kaidah": "Doa Qur'ani untuk memohon keluarga yang sakinah.", "arabic": "رَبَّنَا هَبْ لَنَا مِنْ أَزْوَاجِنَا وَذُرِّيَّاتِنَا قُرَّةَ أَعْyُنٍ وَاجْعَلْنَا لِلْمُتَّقِينَ إِمَامًا", "latin": "Rabbanā hab lanā min azwājinā wa żurriyyātinā qurrata a‘yunin, waj‘alnā lil-muttaqīna imāmā.", "translation": "Ya Tuhan kami, anugerahkanlah kepada kami dari pasangan-pasangan kami dan keturunan kami penyejuk mata, dan jadikanlah kami pemimpin bagi orang-orang bertakwa.", "source": "QS al-Furqān:74." },
    { "id": 22, "title": "Doa Memohon Keturunan Saleh (Nabi Ibrahim)", "category": "Doa Keluarga", "kaidah": "Doa Nabi Ibrahim saat memohon keturunan yang baik dan saleh.", "arabic": "رَبِّ هَبْ لِي مِنَ الصَّالِحِينَ", "latin": "Rabbi hab lī minaṣ-ṣāliḥīn.", "translation": "Ya Tuhanku, anugerahkanlah kepadaku (keturunan) yang termasuk orang-orang saleh.", "source": "QS aṣ-Ṣāffāt:100." },
    { "id": 23, "title": "Doa Memohon Keturunan (Nabi Zakaria)", "category": "Doa Keluarga", "kaidah": "Doa Nabi Zakaria agar tidak hidup seorang diri.", "arabic": "رَبِّ لَا تَذَرْنِي فَرْدًا وَأَنْتَ خَيْرُ الْوَارِثِينَ", "latin": "Rabbi lā tażarnī fardaw wa anta khairul-wāriṡīn.", "translation": "Ya Tuhanku, janganlah Engkau membiarkan aku hidup seorang diri, dan Engkaulah Waris Yang Paling Baik.", "source": "QS Al-Anbiya': 89." },
    { "id": 24, "title": "Agar Diri & Keturunan Rajin Shalat", "category": "Doa Keluarga", "kaidah": "Doa Nabi Ibrahim agar diri dan anak cucunya istiqamah dalam mendirikan shalat.", "arabic": "رَبِّ اجْعَلْنِي مُقِيمَ الصَّلَاةِ وَمِنْ ذُرِّيَّتِي ۚ رَبَّنَا وَتَقَبْبَلْ دُعَاءِ", "latin": "Rabbij‘alnī muqīmaṣ-ṣalāti wa min żurriyyatī; rabbanā wa taqabbal du‘ā’.", "translation": "Ya Tuhanku, jadikanlah aku orang yang menegakkan shalat, dan (juga) dari keturunanku; ya Tuhan kami, perkenankanlah doaku.", "source": "QS Ibrāhīm:40." },
    { "id": 25, "title": "Perlindungan untuk Anak", "category": "Doa Keluarga", "kaidah": "Doa yang dibacakan Nabi Muhammad ﷺ untuk melindungi kedua cucunya.", "arabic": "أُعِيذُكُمَا بِكَلِمَاتِ اللَّهِ التَّامَّةِ مِنْ كُلِّ شَيْطَانٍ وَهَامَّةٍ وَمِنْ كُلِّ عَيْنٍ لَامَّةٍ", "latin": "U‘īdhukumā bikalimātillāhi at-tāmmati min kulli syaiṭānin wa hāmmatin wa min kulli ‘aynin lāmmah.", "translation": "Aku memohonkan perlindungan bagi kalian berdua dengan kalimat-kalimat Allah yang sempurna dari setiap setan, binatang berbahaya, dan pandangan mata yang buruk.", "source": "HR Bukhari." },
    { "id": 27, "title": "Doa Umum untuk Kaum Beriman", "category": "Doa Umat", "kaidah": "Doa Nabi Nuh untuk memohon ampunan bagi seluruh kaum mukminin dan mukminat.", "arabic": "رَبِّ اغْفِرْ لِي وَلِوَالِدَيَّ وَلِمَنْ دَخَلَ بَيْتِيَ مُؤْمِنًا وَلِلْمُؤْمِنِينَ وَالْمُؤْمِنَاتِ وَلَا تَزِدِ الظَّالِمِينَ إِلَّا تَبَارًا", "latin": "Rabbighfir lī wa liwālidayya wa liman dakhala baitiya mu’minaw wa lil-mu’minīna wal-mu’mināt, wa lā tazidiẓ-ẓālimīna illā tabārā.", "translation": "Ya Tuhanku, ampunilah aku, kedua orang tuaku, orang yang masuk ke rumahku sebagai orang beriman, serta semua orang mukmin laki-laki dan perempuan, dan janganlah Engkau tambahkan bagi orang-orang zalim selain kebinasaan.", "source": "QS Nuh: 28." },
    { "id": 28, "title": "Doa Pembuka Rezeki (Ilmu, Rezeki, Amal)", "category": "Doa Hajat Dunia", "kaidah": "Paket doa pagi Nabi ﷺ: memohon ilmu bermanfaat, rezeki baik, dan amal diterima.", "arabic": "اللَّهُمَّ إِنِّي أَсْأَلُكَ عِلْمًا نَافِعًا، وَرِزْقًا طَيِّبًا، وَعَمَلًا مُتَقَبْبَلًا", "latin": "Allāhumma innī as’aluka ‘ilman nāfi‘ā, wa rizqan ṭayyibā, wa ‘amalan mutaqabbalā.", "translation": "Ya Allah, aku memohon kepada-Mu ilmu yang bermanfaat, rezeki yang baik, dan amal yang diterima.", "source": "HR Ibnu Majah (sahih)." },
    { "id": 29, "title": "Doa Nabi Musa Memohon Kebaikan/Rezeki", "category": "Doa Hajat Dunia", "kaidah": "Ekspresi kebutuhan seorang hamba akan segala bentuk kebaikan dari Allah.", "arabic": "رَبِّ إِنِّي لِمَا أَنْزَلْتَ إِلَيَّ مِنْ خَيْرٍ فَقِيرٌ", "latin": "Rabbi innī limā anzalta ilayya min khayrin faqīr.", "translation": "Ya Tuhanku, sesungguhnya aku sangat memerlukan kebaikan apa pun yang Engkau turunkan kepadaku.", "source": "QS Al-Qasas: 24." },
    { "id": 30, "title": "Doa Pelunas Utang & Pencukup Rezeki", "category": "Doa Hajat Dunia", "kaidah": "Doa ma'tsur yang komprehensif untuk terbebas dari utang dan kefakiran.", "arabic": "اللَّهُمَّ رَبَّ السَّمَاوَاتِ السَّبْعِ وَرَبَّ الْعَرْشِ الْعَظِيمِ، رَبَّنَا وَرَبَّ كُلِّ شَيْءٍ، فَالِقَ الْحَبِّ وَالنَّوَى، وَمُنْزِلَ التَّوْرَاةِ وَالْإِنْجِيلِ وَالْفُرْقَانِ، أَعُوذُ بِكَ مِنْ شَرِّ كُلِّ شَيْءٍ أَنْتَ آخِذٌ بِنَاصِيَتِهِ. اللَّهُمَّ أَنْتَ الْأَوَّلُ فَلَيْسَ قَبْلَكَ شَيْءٌ، وَأَنْتَ الْآخِرُ فَلَيْسَ بَعْدَكَ شَيْءٌ، وَأَنْتَ الظَّاهِرُ فَلَيْсَ فَوْقَكَ شَيْءٌ، وَأَنْتَ الْبَاطِنُ فَلَيْسَ دُونَكَ شَيْءٌ، اقْضِ عَنَّا الدَّيْنَ وَأَغْنِنَا مِنَ الْفَقْرِ.", "latin": "Allāhumma rabbas-samāwātis-sab‘i wa rabbal-‘arsyil-‘aẓīm, rabbanā wa rabba kulli syay’, fāliqal-ḥabbi wan-nawā, wa munzilat-tawrāti wal-injīli wal-furqān, a‘ūdzu bika min syarri kulli syay’in anta ākhidzum bināṣiyatih. Allāhumma antal-awwalu falaysa qablaka syay’, wa antal-ākhiru falaysa ba‘daka syay’, wa antaẓ-ẓāhiru falaysa fauqaka syay’, wa antal-bāṭinu falaysa dūnaka syay’, iqḍi ‘annad-dayna wa aghninā minal-faqr.", "translation": "Ya Allah, Tuhan tujuh langit dan Rabb ‘Arsy yang agung, Rabb kami dan Rabb segala sesuatu, Pembelah biji dan benih, Penurun Taurat, Injil, dan Furqan. Aku berlindung kepada-Mu dari kejahatan segala sesuatu yang Engkau pegang ubun-ubunnya. Ya Allah, Engkaulah Yang Awal, tiada sesuatu sebelum-Mu. Engkaulah Yang Akhir, tiada sesuatu setelah-Mu. Engkaulah Yang Zhahir, tiada sesuatu di atas-Mu. Engkaulah Yang Batin, tiada sesuatu di bawah-Mu. Lunasilah utang kami dan cukupkan kami dari kefakiran.", "source": "HR Muslim." },
    { "id": 31, "title": "Doa Memohon Kemudahan Urusan (Umum)", "category": "Doa Hajat Dunia", "kaidah": "Doa untuk meminta Allah menjadikan segala urusan yang sulit menjadi mudah.", "arabic": "اللَّهُمَّ لَا سَهْلَ إِلَّا مَا جَعَلْتَهُ سَهْلًا، وَأَنْتَ تَجْعَلُ الْحَزْنَ إِذَا شِئْتَ سَهْلًا", "latin": "Allāhumma lā sahla illā mā ja‘altahū sahlā, wa anta taj‘alul-ḥazna idzā syi’ta sahlā.", "translation": "Ya Allah, tiada kemudahan kecuali apa yang Engkau jadikan mudah; dan Engkau menjadikan kesulitan, jika Engkau kehendaki, menjadi mudah.", "source": "HR Ibnu Ḥibbān (hasan)." },
    { "id": 32, "title": "Doa Nabi Musa (Kelapangan & Kemudahan Komunikasi)", "category": "Doa Hajat Dunia", "kaidah": "Doa Nabi Mūsā: lapang dada, mudah urusan, lancar bicara.", "arabic": "رَبِّ اشْرَحْ لِي صَدْرِي، وَيَسِّرْ لِي أَمْرِي، وَاحْلُلْ عُقْدَةً مِنْ لِسَانِي، يَفْقَهُوا قَوْلِي", "latin": "Rabbisyraḥ lī ṣadrī, wa yassir lī amrī, waḥlul ‘uqdatan min lisānī, yafqahū qawlī.", "translation": "Ya Tuhanku, lapangkanlah dadaku, mudahkanlah urusanku, dan lepaskanlah kekakuan dari lidahku agar mereka memahami perkataanku.", "source": "QS Ṭāhā: 25–28." },
    { "id": 33, "title": "Doa Ashabul Kahfi (Memohon Rahmat & Petunjuk)", "category": "Doa Hajat Dunia", "kaidah": "Doa para pemuda Kahfi saat menghadapi kesulitan, memohon rahmat dan jalan keluar yang lurus.", "arabic": "رَبَّنَا آتِنَا مِنْ لَدُنْكَ رَحْمَةً وَهَيِّئْ لَنَا مِنْ أَمْرِنَا رَشَدًا", "latin": "Rabbanā ātinā mil ladunka raḥmah, wa hayyi’ lanā min amrinā rasyadā.", "translation": "Ya Tuhan kami, anugerahkanlah kepada kami rahmat dari sisi-Mu dan berilah kemudahan yang lurus bagi urusan kami.", "source": "QS Al-Kahfi: 10." },
    { "id": 34, "title": "Doa Tawakal (Merasa Cukup dengan Allah)", "category": "Doa Hajat Dunia", "kaidah": "Pernyataan tawakal total, dibaca saat gentar/cemas untuk menguatkan hati.", "arabic": "حَسْبُنَا اللَّهُ وَنِعْمَ الْوَكِيلُ. \n\nحَسْبِيَ اللَّهُ لَا إِلَٰهَ إِلَّا هُوَ ۖ عَلَيْهِ تَوَكَّلْتُ ۖ وَهُوَ رَبُّ الْعَرْشِ الْعَظِيمِ", "latin": "Ḥasbunallāhu wa ni‘mal-wakīl. Hasbiyallāhu lā ilāha illā huwa, 'alaihi tawakkaltu wa huwa rabbul-'arsyil-'aẓīm.", "translation": "Cukuplah Allah bagi kami, dan Dia sebaik-baik Pelindung. Cukuplah Allah bagiku; tidak ada tuhan selain Dia. Hanya kepada-Nya aku bertawakal dan Dia adalah Tuhan yang memiliki 'Arsy yang agung.", "source": "QS Āli ‘Imrān:173 & QS At-Taubah:129." },
    { "id": 35, "title": "Perlindungan dari 8 Kesulitan Hidup", "category": "Doa Perlindungan", "kaidah": "Benteng dari gelisah, sedih, lemah, malas, pengecut, kikir, lilitan utang, dan tekanan manusia.", "arabic": "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنَ الْهَمِّ وَالْحَزَنِ، وَالْعَجْزِ وَالْكَسَلِ، وَالْجُبْنِ وَالْبُخْلِ، وَغَلَبَةِ الدَّيْنِ وَقَهْرِ الرِّجَالِ", "latin": "Allāhumma innī a‘ūdzu bika minal-hammi wal-ḥazan, wal-‘ajzi wal-kasal, wal-jubni wal-bukhl, wa ghalabatid-dayni wa qahrir-rijāl.", "translation": "Ya Allah, aku berlindung kepada-Mu dari kegundahan dan kesedihan, dari lemah dan malas, dari pengecut dan kikir, dan dari dominasi utang serta penindasan manusia.", "source": "HR Bukhari." },
    { "id": 36, "title": "Perlindungan dari Ilmu Tak Bermanfaat & Hati Tak Khusyuk", "category": "Doa Perlindungan", "kaidah": "Empat perlindungan inti: dari ilmu tak bermanfaat, hati tak khusyuk, jiwa tak pernah puas, dan doa tak didengar.", "arabic": "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنْ عِلْمٍ لَا يَنْفَعُ، وَمِنْ قَلْبٍ لَا يَخْشَعُ، وَمِنْ نَفْسٍ لَا تَشْبَعُ، وَمِنْ دَعْوَةٍ لَا يُسْتَجَابُ لَهَا", "latin": "Allāhumma innī a‘ūdzu bika min ‘ilmin lā yanfa‘, wa min qalbin lā yakhsha‘, wa min nafsin lā tasyba‘, wa min da‘watin lā yustajābu lahā.", "translation": "Ya Allah, aku berlindung kepada-Mu dari ilmu yang tidak bermanfaat, dari hati yang tidak khusyuk, dari jiwa yang tidak pernah puas, dan dari doa yang tidak dikabulkan.", "source": "HR Muslim." },
    { "id": 37, "title": "Perlindungan dari Kemiskinan, Kehinaan & Kezaliman", "category": "Doa Perlindungan", "kaidah": "Minta dijauhkan dari kefakiran, kekurangan, kehinaan; juga dari menzhalimi atau dizhalimi.", "arabic": "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنَ الْفَقْرِ وَالْقِلَّةِ وَالذِّلَّةِ، وَأَعُوذُ بِكَ مِنْ أَنْ أَظْلِمَ أَوْ أُظْلَمَ", "latin": "Allāhumma innī a‘ūdzu bika minal-faqri wal-qillati wadz-dzillah, wa a‘ūdzu bika min an aẓlima aw uẓlam.", "translation": "Ya Allah, aku berlindung kepada-Mu dari kefakiran, kekurangan, dan kehinaan; serta dari menzalimi atau dizalimi.", "source": "HR Abu Dawud (hasan)." },
    { "id": 38, "title": "Perlindungan dari Bencana & Wabah", "category": "Doa Perlindungan", "kaidah": "Memohon perlindungan dari penyakit berat seperti belang, gila, kusta, dan penyakit buruk lainnya.", "arabic": "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنَ الْبَرَصِ، وَالْجُنُونِ، وَالْجُذَامِ، وَمِنْ سَيِّئِ الْأَسْقَامِ", "latin": "Allāhumma innī a‘ūdzu bika minal-baraṣ, wal-junūn, wal-jużām, wa min sayyi’il-asqām.", "translation": "Ya Allah, aku berlindung kepada-Mu dari penyakit belang, gila, kusta, dan dari penyakit-penyakit yang buruk.", "source": "HR Abu Dawud (hasan)." },
    { "id": 39, "title": "Dzikir Perlindungan Pagi-Petang", "category": "Doa Perlindungan", "kaidah": "Dibaca tiga kali pagi dan petang untuk perlindungan menyeluruh.", "arabic": "بِسْمِ اللَّهِ الَّذِي لَا يَضُرُّ مَعَ اسْمِهِ شَيْءٌ فِي الْأَرْضِ وَلَا فِي السَّمَاءِ وَهُوَ السَّمِيعُ الْعَلِيمُ", "latin": "Bismillāhilladzī lā yaḍurru ma‘asmihī syai’un fil-arḍi wa lā fis-samā’, wa huwas-samī‘ul-‘alīm.", "translation": "Dengan nama Allah, yang dengan nama-Nya tidak ada sesuatu pun di bumi dan di langit yang dapat membahayakan, dan Dia Maha Mendengar lagi Maha Mengetahui.", "source": "HR Abu Dawud & Tirmidzi (hasan)." },
    { "id": 40, "title": "Memohon Kesehatan & Kesembuhan Total", "category": "Doa Kesehatan", "kaidah": "Ruqyah Nabi: Asy-Syāfī hanya Allah; mohon kesembuhan tuntas.", "arabic": "اللَّهُمَّ رَبَّ النَّاسِ، أَذْهِبِ الْبَأْسَ، اشْفِ أَنْتَ الشَّافِي، لَا شِفَاءَ إِلَّا شِفَاؤُكَ، شِفَاءً لَا يُغَادِرُ سَقَمًا", "latin": "Allāhumma rabban-nās, adzhibil-ba’s, isyfi anta asy-Syāfī, lā syifā’a illā syifā’uka, syifā’an lā yughadiru saqamā.", "translation": "Ya Allah, Tuhan manusia, hilangkanlah penyakit; sembuhkanlah, Engkaulah Sang Penyembuh; tidak ada kesembuhan kecuali kesembuhan dari-Mu; kesembuhan yang tidak menyisakan penyakit.", "source": "HR Bukhari & Muslim." },
    { "id": 41, "title": "Doa Nabi Ayyub Saat Kesusahan & Sakit", "category": "Doa Kesehatan", "kaidah": "Untuk ujian berat: sakit, kehilangan, tekanan.", "arabic": "أَنِّي مَسَّنِيَ الضُّرُّ وَأَنْتَ أَرْحَمُ الرَّاحِمِينَ", "latin": "Annī massaniyaḍ-ḍurru wa anta ar-ḥamur-rāḥimīn.", "translation": "Sesungguhnya aku telah ditimpa kesusahan, dan Engkaulah Yang Maha Penyayang di antara para penyayang.", "source": "QS al-Anbiyā’:83." },
    { "id": 42, "title": "Memohon Pekerjaan Terbaik", "category": "Doa Rezeki & Pekerjaan", "kaidah": "Doa umum: memohon pekerjaan yang saleh, berkah, dan mencukupi.", "arabic": "اللَّهُمَّ ارْزُقْنِي عَمَلًا صَالِحًا مُبَارَكًا قَرِيبًا مِنْ مَسْقَطِ رَأْسِي، تَكْفِينِي بِهِ حَاجَاتِ أَهْلِي وَتُقَوِّي بِهِ دِينِي", "latin": "Allāhummarzuqnī ‘amalan ṣāliḥan mubārakan qarīban min masqaṭi ra’sī, takfīnī bihī ḥājāti ahli, wa tuqawwī bihī dīnī.", "translation": "Ya Allah, karuniakan kepadaku pekerjaan yang saleh lagi berkah, yang dekat dari tempat tinggalku; dengannya cukupilah kebutuhan keluargaku dan kuatkanlah agamaku.", "source": "Doa umum (ghairu ma’tsur)." },
    { "id": 43, "title": "Memohon Kelapangan Rezeki (Target Spesifik)", "category": "Doa Rezeki & Pekerjaan", "kaidah": "Boleh meminta nominal spesifik selama niatnya untuk ketaatan.", "arabic": "اللَّهُمَّ يَا رَزَّاقُ يَا فَتَّاحُ، ارْزُقْنِي رِزْقًا وَاسِعًا حَلَالًا طَيِّبًا مُبَارَكًا فِيهِ، وَاجْعَلْ مَالِي يَبْلُغُ مِلْيَارَهُ الْأَوَّلَ وَمَا بَعْدَهُ، وَاجْعَلْهُ عَوْنًا لِي عَلَى طَاعَتِكَ وَسَبِيلًا لِنَيْلِ رِضَاكَ", "latin": "Allāhumma yā Razzāq, yā Fattāḥ, urzuqnī rizqan wāsi‘an ḥalālan ṭayyiban mubārakan fīh, waj‘al mālī yablughu milyārahu al-awwala wa mā ba‘dah, waj‘alhu ‘awnan lī ‘alā ṭā‘atika wa sabīlan linayli riḍāk.", "translation": "Ya Allah, wahai Yang Maha Pemberi Rezeki, wahai Yang Maha Membuka, berilah aku rezeki yang luas, halal, baik, dan diberkahi. Jadikan hartaku mencapai satu miliar pertamanya dan sesudahnya, dan jadikan harta itu penolong bagiku untuk taat kepada-Mu dan jalan meraih ridha-Mu.", "source": "Doa umum (ghairu ma’tsur)." },
    { "id": 44, "title": "Kekayaan & Keberkahan (Doa untuk Anas r.a.)", "category": "Doa Rezeki & Pekerjaan", "kaidah": "Memohon diperbanyak harta/anak, keberkahan, umur panjang dalam taat, dan ampunan.", "arabic": "اللَّهُمَّ أَكْثِرْ مَالِي وَوَلَدِي، وَبَارِكْ لِي فِيمَا أَعْطَيْتَنِي، وَأَطِلْ حَيَاتِي عَلَى طَاعَتِكَ، وَأَحْسِنْ عَمَلِي وَاغْفِرْ لِي", "latin": "Allāhumma akṡir mālī wa waladī, wa bārik lī fīmā a‘ṭaitanī, wa aṭil ḥayātī ‘alā ṭā‘atik, wa aḥsin ‘amalī, waghfir lī.", "translation": "Ya Allah, perbanyaklah hartaku dan anakku, dan berkahilah bagiku pada apa yang Engkau berikan; panjangkanlah hidupku dalam ketaatan kepada-Mu; perbaikilah amal perbuatanku; dan ampunilah aku.", "source": "Inti doa dari HR Bukhari & Muslim." },
    { "id": 45, "title": "Agar Diri Sifat Qanā‘ah (Merasa Cukup)", "category": "Doa Rezeki & Pekerjaan", "kaidah": "Kaya sejati: hati yang merasa cukup dengan rezeki Allah.", "arabic": "اللَّهُمَّ قَنِّعْنِي بِمَا رَزَقْتَنِي، وَبَارِكْ لِي فِيهِ، وَاخْلُفْ عَلَى كُلِّ غَائِبَةٍ لِي بِخَيْرٍ", "latin": "Allāhumma qanni‘nī bimā razaqtanī, wa bārik lī fīh, wakhluf ‘alā kulli ghā’ibatin lī bikhayr.", "translation": "Ya Allah, jadikan aku merasa cukup dengan apa yang Engkau rezekikan kepadaku; berkahilah itu bagiku; dan gantilah setiap yang luput dariku dengan yang lebih baik.", "source": "HR al-Ḥākim (hasan)." },
    { "id": 46, "title": "Memohon Tambahan Ilmu", "category": "Doa Ilmu & Karunia", "kaidah": "Doa singkat dan padat untuk meminta tambahan ilmu.", "arabic": "رَّبِّ زِدْنِي عِلْمًا", "latin": "Rabbi zidnī ‘ilmā.", "translation": "Ya Tuhanku, tambahkanlah kepadaku ilmu.", "source": "QS Ṭāhā: 114." },
    { "id": 47, "title": "Memohon Karunia Allah", "category": "Doa Ilmu & Karunia", "kaidah": "Doa singkat, padat, dan sangat luas maknanya untuk segala hajat.", "arabic": "اللَّهُمَّ إِنِّي أَسْأَلُكَ مِنْ فَضْلِكَ", "latin": "Allāhumma innī as’aluka min faḍlik.", "translation": "Ya Allah, aku memohon kepada-Mu dari karunia-Mu.", "source": "HR Muslim." },
    { "id": 48, "title": "Memohon Rahmat yang Luas", "category": "Doa Ilmu & Karunia", "kaidah": "Meminta rahmat Allah yang meliputi segala sesuatu.", "arabic": "اللَّهُمَّ إِنِّي أَسْأَلُكَ رَحْمَتَكَ الَّتِي وَسِعَتْ كُلَّ شَيْءٍ", "latin": "Allāhumma innī as’aluka raḥmatakallatī wasi‘at kulla syay’.", "translation": "Ya Allah, aku memohon kepada-Mu rahmat-Mu yang telah meliputi segala sesuatu.", "source": "Riwayat doa qiyamul-lail (hasan)." },
    { "id": 49, "title": "Doa Sapu Jagat (Kebaikan Dunia & Akhirat)", "category": "Doa Keselamatan Akhirat", "kaidah": "Doa paling ringkas dan mencakup segalanya: dunia baik, akhirat baik, selamat dari neraka.", "arabic": "رَبَّنَا آتِنَا فِي الدُّنْيَا حَسَنَةً وَفِي الْآخِرَةِ حَسَنَةً وَقِنَا عَذَابَ النَّارِ", "latin": "Rabbanā ātinā fid-dunyā ḥasanah, wa fil-ākhirati ḥasanah, wa qinā ‘adzāban-nār.", "translation": "Ya Tuhan kami, anugerahkanlah kepada kami kebaikan di dunia dan kebaikan di akhirat, dan lindungilah kami dari azab neraka.", "source": "QS al-Baqarah:201." },
    { "id": 50, "title": "Perlindungan dari Siksa Kubur, Neraka, & Fitnah Dajjal", "category": "Doa Keselamatan Akhirat", "kaidah": "Empat perlindungan utama yang dibaca di akhir tasyahhud sebelum salam.", "arabic": "اللَّهُمَّ إِنِّي أَعُوذُ بِكَ مِنْ عَذَابِ الْقَبْرِ، وَمِنْ عَذَابِ جَهَنَّمَ، وَمِنْ فِتْنَةِ الْمَحْيَا وَالْمَمَاتِ، وَمِنْ شَرِّ فِتْنَةِ الْمَسِيحِ الدَّجَّالِ", "latin": "Allāhumma innī a‘ūdzu bika min ‘adzābil-qabr, wa min ‘adzābi Jahannam, wa min fitnatil-maḥyā wal-mamāt, wa min syarri fitnatil-Masīḥid-Dajjāl.", "translation": "Ya Allah, aku berlindung kepada-Mu dari azab kubur, dari azab neraka Jahannam, dari fitnah kehidupan dan kematian, dan dari kejahatan fitnah Al-Masih ad-Dajjal.", "source": "HR Bukhari & Muslim." },
    { "id": 51, "title": "Memohon Husnul Khātimah", "category": "Doa Keselamatan Akhirat", "kaidah": "Permohonan agar akhir umur, amal, dan hari-hari kita menjadi yang terbaik.", "arabic": "اللَّهُمَّ اجْعَلْ خَيْرَ عُمْرِي آخِرَهُ، وَخَيْرَ عَمَلِي خَوَاتِمَهُ، وَخَيْرَ أَيَّامِي يَوْمَ أَلْقَاكَ فِيهِ", "latin": "Allāhummaj‘al khayra ‘umrī ākhirah, wa khayra ‘amalī khawātimah, wa khayra ayyāmī yauma alqāka fīh.", "translation": "Ya Allah, jadikanlah sebaik-baik umurku adalah pengujungnya, sebaik-baik amal perbuatanku adalah penutupnya, dan sebaik-baik hariku adalah hari ketika aku berjumpa dengan-Mu.", "source": "Doa ma'tsur." },
    { "id": 52, "title": "Memohon Surga Firdaus Tanpa Hisab", "category": "Doa Keselamatan Akhirat", "kaidah": "Puncak harapan: Firdaus al-A‘lā tanpa hisab dan azab.", "arabic": "اللَّهُمَّ إِنِّي أَسْأَلُكَ الْفِرْدَوْسَ الْأَعْلَى مِنَ الْجَنَّةِ بِغَيْرِ حِسَابٍ وَلَا سَابِقَةِ عَذَابٍ", "latin": "Allāhumma innī as’alukal-firdausal-a‘lā minal-jannah, bi-ghayri ḥisābin wa lā sābiqata ‘adzāb.", "translation": "Ya Allah, aku memohon kepada-Mu Surga Firdaus yang tertinggi, tanpa hisab dan tanpa didahului azab.", "source": "Doa umum (makna dari HR Bukhari)." },
    { "id": 53, "title": "Doa dengan Ismul A‘ẓam (Nama Allah Teragung)", "category": "Doa Mustajab", "kaidah": "Dua redaksi doa yang disebut dalam hadis mengandung Ismul A‘ẓam, yang jika berdoa dengannya akan dikabulkan.", "arabic": "النَّصُّ ١:\nاللَّهُمَّ إِنِّي أَسْأَلُكَ بِأَنَّ لَكَ الْحَمْدَ، لَا إِلَهَ إِلَّا أَنْتَ، الْمَنَّانُ، بَدِيعُ السَّمَاوَاتِ وَالْأَرْضِ، يَا ذَا الْجَلَالِ وَالْإِكْرَامِ، يَا حَيُّ يَا قَيُّومُ.\n\nالنَّصُّ ٢:\nاللَّهُمَّ إِنِّي أَسْأَلُكَ بِأَنِّي أَشْهَدُ أَنَّكَ أَنْتَ اللَّهُ لَا إِلَهَ إِلَّا أَنْتَ، الْأَحَدُ الصَّمَدُ، الَّذِي لَمْ يَلِدْ وَلَمْ يُولَدْ، وَلَمْ يَكُنْ لَهُ كُفُوًا أَحَدٌ.", "latin": "Redaksi 1: Allāhumma innī as’aluka bi-anna lakal-ḥamd, lā ilāha illā ant, al-Mannān, badī‘us-samāwāti wal-arḍ, yā dzal-jalāli wal-ikrām, yā Ḥayyu yā Qayyūm.\nRedaksi 2: Allāhumma innī as’aluka bi-annī asyhadu annaka Antallāh, lā ilāha illā anta, al-Aḥaduṣ-Ṣamad, alladzī lam yalid wa lam yūlad, wa lam yakun lahu kufuwan aḥad.", "translation": "Dua redaksi: (1) Dengan pujian, al-Mannān, yā Ḥayyu yā Qayyūm; (2) Dengan kesaksian bahwa Engkau adalah Allah Yang Esa, aṣ-Ṣamad, tidak beranak dan tidak diperanakkan.", "source": "1) HR Abu Dawud, an-Nasa’i; 2) HR Tirmidzi." },
    { "id": 54, "title": "Ayat Penguat Keyakinan (Kun Fayakūn)", "category": "Penguat Keyakinan", "kaidah": "Meneguhkan iman pada kekuasaan Allah yang mutlak. Bukan doa, tapi dibaca untuk menguatkan hati.", "arabic": "إِنَّمَا أَمْرُهُ إِذَا أَرَادَ شَيْئًا أَنْ يَقُولَ لَهُ كُنْ فَيَكُونُ", "latin": "Innamā amruhū iżā arāda syai’an an yaqūla lahū kun fa yakūn.", "translation": "Sesungguhnya urusan-Nya, apabila Dia menghendaki sesuatu, hanyalah berkata kepadanya: Jadilah! maka jadilah ia.", "source": "QS Yā-Sīn: 82." },
    { "id": 55, "title": "Doa Agar Amalan Diterima", "category": "Pembukaan & Penutup Doa", "kaidah": "Adab setelah beramal: memohon agar diterima, bukan berbangga.", "arabic": "رَبَّنَا تَقَبَّلْ مِنَّا ۖ إِنَّكَ أَنْتَ السَّمِيعُ الْعَلِيمُ. وَتُبْ عَلَيْنَا ۖ إِنَّكَ أَنْتَ التَّوَّابُ الرَّحِيمُ.", "latin": "Rabbanā taqabbal minnā, innaka antas-samī‘ul-‘alīm. Wa tub ‘alainā, innaka antat-tawwābur-raḥīm.", "translation": "Ya Tuhan kami, terimalah dari kami (amal ini). Sungguh, Engkaulah Yang Maha Mendengar, Maha Mengetahui. Dan terimalah tobat kami, sungguh Engkaulah Maha Penerima Tobat, Maha Penyayang.", "source": "QS al-Baqarah:127-128." },
    { "id": 56, "title": "Pujian Penutup & Salam untuk Para Rasul", "category": "Pembukaan & Penutup Doa", "kaidah": "Tiga ayat penutup yang memuji Allah dan menebar salam kepada para rasul.", "arabic": "سُبْحَانَ رَبِّكَ رَبِّ الْعِزَّةِ عَمَّا يَصِفُونَ • وَسَلَامٌ عَلَى الْمُرْسَلِينَ • وَالْحَمْدُ لِلَّهِ رَبِّ الْعَالَمِينَ", "latin": "Subḥāna rabbika rabbil-‘izzati ‘ammā yaṣifūn. Wa salāmun ‘alal-mursalīn. Wal-ḥamdu lillāhi rabbil-‘ālamīn.", "translation": "Mahasuci Tuhanmu, Tuhan Yang Mahaperkasa, dari apa yang mereka sifatkan. Dan kesejahteraan atas para rasul. Dan segala puji bagi Allah, Tuhan seluruh alam.", "source": "QS As-Ṣaffāt:180–182." },
    { "id": 57, "title": "Kaffaratul Majlis (Penutup Doa & Majelis)", "category": "Pembukaan & Penutup Doa", "kaidah": "Dzikir penebus dosa dalam suatu majelis; sangat baik dibaca sebagai penutup rangkaian doa.", "arabic": "سُبْحَانَكَ اللَّهُمَّ وَبِحَمْدِكَ، أَشْهَدُ أَنْ لَا إِلَهَ إِلَّا أَنْتَ، أَسْتَغْفِرُكَ وَأَتُوبُ إِلَيْكَ", "latin": "Subḥānaka Allāhumma wa biḥamdika, asyhadu an lā ilāha illā anta, astaghfiruka wa atūbu ilaik.", "translation": "Mahasuci Engkau ya Allah, dan dengan memuji-Mu. Aku bersaksi tiada tuhan selain Engkau. Aku memohon ampun kepada-Mu dan bertobat kepada-Mu.", "source": "HR Tirmidzi (hasan sahih)." }
];

// -- IKON SVG (Pengganti Lucide React) --
const Icon = ({ name, className }) => {
    const icons = {
        menu: <path d="M4 6h16M4 12h16M4 18h16" />,
        plus: <path d="M12 5v14m-7-7h14" />,
        search: <><circle cx="11" cy="11" r="8" /><path d="m21 21-4.3-4.3" /></>,
        chevronDown: <path d="m6 9 6 6 6-6" />,
        edit: <><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" /><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" /></>,
        trash: <path d="M3 6h18m-2 0v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2m-6 5v6m4-6v6" />,
        x: <path d="M18 6 6 18M6 6l12 12" />,
        upload: <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4m14-7-5-5-5 5m5-5v12" />,
        download: <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4m4-4 5 5 5-5m-5 5V3" />,
        alert: <><path d="m21.73 18-8-14a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z" /><path d="M12 9v4" /><path d="M12 17h.01" /></>,
        moon: <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z" />,
        sun: <><circle cx="12" cy="12" r="4" /><path d="M12 2v2" /><path d="M12 20v2" /><path d="m4.93 4.93 1.41 1.41" /><path d="m17.66 17.66 1.41 1.41" /><path d="M2 12h2" /><path d="M20 12h2" /><path d="m6.34 17.66-1.41 1.41" /><path d="m19.07 4.93-1.41 1.41" /></>,
        sparkles: <path d="m12 3-1.9 4.8-4.8 1.9 4.8 1.9 1.9 4.8 1.9-4.8 4.8-1.9-4.8-1.9Z"/>
    };
    return (
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
            {icons[name]}
        </svg>
    );
};

// -- KOMPONEN-KOMPONEN UI --

// Komponen Modal untuk Tambah/Edit Doa
const PrayerModal = ({ isOpen, onClose, onSave, prayer, categories }) => {
    const [formData, setFormData] = useState({});

    useEffect(() => {
        if (prayer) {
            setFormData(prayer);
        } else {
            setFormData({ title: '', category: '', kaidah: '', arabic: '', latin: '', translation: '', source: '' });
        }
    }, [prayer, isOpen]);

    if (!isOpen) return null;

    const handleChange = (e) => {
        const { name, value } = e.target;
        setFormData(prev => ({ ...prev, [name]: value }));
    };

    const handleSubmit = (e) => {
        e.preventDefault();
        onSave(formData);
    };

    const inputClass = "w-full px-3 py-2 bg-slate-50 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 text-slate-800 dark:text-slate-200 transition-colors";
    const textareaClass = `${inputClass} h-28 resize-y`;

    return (
        <div className={`fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 transition-opacity duration-300 ${isOpen ? 'opacity-100' : 'opacity-0 pointer-events-none'}`}>
            <div className={`bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto transform transition-transform duration-300 ${isOpen ? 'scale-100' : 'scale-95'}`}>
                <form onSubmit={handleSubmit} className="p-6 sm:p-8 space-y-4">
                    <div className="flex justify-between items-center border-b border-slate-200 dark:border-slate-700 pb-4">
                        <h2 className="text-2xl font-bold text-slate-800 dark:text-slate-100">{prayer ? 'Edit Doa' : 'Tambah Doa Baru'}</h2>
                        <button type="button" onClick={onClose} className="p-1 rounded-full text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors"><Icon name="x" className="w-6 h-6" /></button>
                    </div>

                    <div>
                        <label className="block text-sm font-medium text-slate-600 dark:text-slate-400 mb-1">Judul</label>
                        <input type="text" name="title" value={formData.title || ''} onChange={handleChange} className={inputClass} required />
                    </div>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label className="block text-sm font-medium text-slate-600 dark:text-slate-400 mb-1">Kategori</label>
                             <input type="text" name="category" list="category-list" value={formData.category || ''} onChange={handleChange} className={inputClass} required />
                             <datalist id="category-list">
                                {categories.map(cat => <option key={cat} value={cat} />)}
                             </datalist>
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-slate-600 dark:text-slate-400 mb-1">Sumber</label>
                            <input type="text" name="source" value={formData.source || ''} onChange={handleChange} className={inputClass} />
                        </div>
                    </div>

                    <div>
                        <label className="block text-sm font-medium text-slate-600 dark:text-slate-400 mb-1">Kaidah/Penjelasan</label>
                        <textarea name="kaidah" value={formData.kaidah || ''} onChange={handleChange} className={`${inputClass} h-20`}></textarea>
                    </div>

                    <div>
                        <label className="block text-sm font-medium text-slate-600 dark:text-slate-400 mb-1">Teks Arab</label>
                        <textarea name="arabic" value={formData.arabic || ''} onChange={handleChange} className={`${textareaClass} text-2xl text-right leading-relaxed font-serif`} dir="rtl"></textarea>
                    </div>
                    
                    <div>
                        <label className="block text-sm font-medium text-slate-600 dark:text-slate-400 mb-1">Transliterasi Latin</label>
                        <textarea name="latin" value={formData.latin || ''} onChange={handleChange} className={textareaClass}></textarea>
                    </div>

                    <div>
                        <label className="block text-sm font-medium text-slate-600 dark:text-slate-400 mb-1">Terjemahan</label>
                        <textarea name="translation" value={formData.translation || ''} onChange={handleChange} className={textareaClass}></textarea>
                    </div>

                    <div className="flex justify-end pt-4 space-x-3">
                        <button type="button" onClick={onClose} className="px-5 py-2 bg-slate-200 dark:bg-slate-600 text-slate-800 dark:text-slate-200 rounded-lg hover:bg-slate-300 dark:hover:bg-slate-500 font-semibold transition-colors">Batal</button>
                        <button type="submit" className="px-5 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 font-semibold transition-colors shadow-sm hover:shadow-md">Simpan</button>
                    </div>
                </form>
            </div>
        </div>
    );
};


// Komponen Kad Doa
const PrayerCard = ({ prayer, onEdit, onDelete, onExplain, isActive, onToggle }) => {
    return (
        <div className="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl shadow-sm hover:shadow-lg transition-shadow duration-300 group">
            <div className="p-5 flex justify-between items-start cursor-pointer" onClick={onToggle}>
                <div className="flex-1 pr-4">
                    <span className="text-xs font-semibold uppercase text-teal-600 dark:text-teal-400 tracking-wider">{prayer.category}</span>
                    <h3 className="text-xl font-bold text-slate-800 dark:text-slate-100 mt-1">{prayer.title}</h3>
                </div>
                <div className="flex items-center space-x-1">
                     <button 
                        onClick={(e) => { e.stopPropagation(); onExplain(prayer); }} 
                        className="flex items-center justify-center min-w-[44px] min-h-[44px] text-slate-500 dark:text-slate-400 hover:bg-teal-100 dark:hover:bg-slate-700 hover:text-teal-600 dark:hover:text-teal-400 rounded-full transition-colors"
                        aria-label="Jelaskan doa"
                    >
                        <Icon name="sparkles" className="w-5 h-5"/>
                    </button>
                    <button 
                        onClick={(e) => { e.stopPropagation(); onEdit(prayer); }} 
                        className="flex items-center justify-center min-w-[44px] min-h-[44px] text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-full transition-colors"
                        aria-label="Edit doa"
                    >
                        <Icon name="edit" className="w-5 h-5"/>
                    </button>
                    <button 
                        onClick={(e) => { e.stopPropagation(); onDelete(prayer.id); }} 
                        className="flex items-center justify-center min-w-[44px] min-h-[44px] text-slate-500 dark:text-slate-400 hover:bg-red-100 hover:text-red-600 dark:hover:bg-red-900/50 dark:hover:text-red-400 rounded-full transition-colors"
                        aria-label="Hapus doa"
                    >
                        <Icon name="trash" className="w-5 h-5"/>
                    </button>
                    <div className="p-2 -mr-2">
                         <Icon name="chevronDown" className={`w-6 h-6 text-slate-500 dark:text-slate-400 transform transition-transform duration-300 ${isActive ? 'rotate-180' : ''}`} />
                    </div>
                </div>
            </div>
            <div className={`transition-[max-height,padding] duration-500 ease-in-out overflow-hidden ${isActive ? 'max-h-[2000px]' : 'max-h-0'}`}>
                 <div className="px-5 pb-6 border-t border-slate-100 dark:border-slate-700 space-y-6">
                    {prayer.kaidah && <p className="mt-5 text-sm text-slate-600 dark:text-slate-400 bg-slate-50 dark:bg-slate-700/50 p-4 rounded-lg border-l-4 border-teal-500 dark:border-teal-400"><strong>Kaidah:</strong> {prayer.kaidah}</p>}
                    <p className="text-3xl lg:text-4xl text-right font-serif text-slate-900 dark:text-slate-100 leading-loose" lang="ar" dir="rtl" style={{whiteSpace: 'pre-wrap'}}>{prayer.arabic}</p>
                    <p className="text-md italic text-slate-500 dark:text-slate-400 leading-relaxed">{prayer.latin}</p>
                    <p className="text-md text-slate-700 dark:text-slate-300 leading-relaxed" style={{whiteSpace: 'pre-wrap'}}><strong>Artinya:</strong> "{prayer.translation}"</p>
                    {prayer.source && <p className="text-sm font-medium text-slate-500 dark:text-slate-400 pt-4 border-t border-slate-200 dark:border-slate-700"><strong>Sumber:</strong> {prayer.source}</p>}
                </div>
            </div>
        </div>
    );
};

const GeminiExplanationModal = ({ isOpen, onClose, prayer, explanation, isLoading }) => {
    if (!isOpen) return null;

    return (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
            <div className="bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col">
                <div className="p-6 border-b border-slate-200 dark:border-slate-700">
                    <div className="flex justify-between items-start">
                        <div>
                           <h2 className="text-2xl font-bold text-slate-800 dark:text-slate-100">Penjelasan Doa</h2>
                           <p className="text-slate-600 dark:text-slate-400 mt-1">{prayer?.title || ''}</p>
                        </div>
                        <button onClick={onClose} className="p-1 rounded-full text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors"><Icon name="x" className="w-6 h-6" /></button>
                    </div>
                </div>
                <div className="p-6 overflow-y-auto">
                    {isLoading ? (
                        <div className="flex flex-col items-center justify-center h-48">
                           <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-teal-500"></div>
                           <p className="mt-4 text-slate-500 dark:text-slate-400">Gemini sedang berpikir...</p>
                        </div>
                    ) : (
                        <div className="prose prose-slate dark:prose-invert max-w-none whitespace-pre-wrap" dangerouslySetInnerHTML={{ __html: explanation }} />
                    )}
                </div>
            </div>
        </div>
    );
}

const GeminiGenerateModal = ({ isOpen, onClose, onSave }) => {
    const [topic, setTopic] = useState('');
    const [generatedPrayer, setGeneratedPrayer] = useState(null);
    const [isLoading, setIsLoading] = useState(false);
    const [error, setError] = useState('');

    const handleGenerate = async () => {
        if (!topic.trim()) {
            setError('Silakan masukkan topik doa.');
            return;
        }
        setIsLoading(true);
        setError('');
        setGeneratedPrayer(null);

        const systemPrompt = "Anda adalah seorang ahli dalam ilmu Islam dan bahasa Arab yang membantu menghasilkan doa-doa Islami. Jawab dalam format JSON yang ketat.";
        const userQuery = `Buatkan doa Islami mengenai "${topic}". Sertakan teks Arab, transliterasi Latin, dan terjemahan dalam Bahasa Indonesia.`;
        const apiKey = ""; // API key akan disediakan oleh environment
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

        const payload = {
            contents: [{ parts: [{ text: userQuery }] }],
            systemInstruction: { parts: [{ text: systemPrompt }] },
            generationConfig: {
                responseMimeType: "application/json",
                responseSchema: {
                    type: "OBJECT",
                    properties: {
                        "title": { "type": "STRING" },
                        "arabic": { "type": "STRING" },
                        "latin": { "type": "STRING" },
                        "translation": { "type": "STRING" }
                    },
                    required: ["title", "arabic", "latin", "translation"]
                }
            }
        };

        try {
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
            if (!response.ok) {
                throw new Error(`Permintaan API gagal dengan status ${response.status}`);
            }
            const result = await response.json();
            const text = result.candidates?.[0]?.content?.parts?.[0]?.text;
            if (text) {
                setGeneratedPrayer(JSON.parse(text));
            } else {
                throw new Error("Respon API tidak valid.");
            }
        } catch (e) {
            console.error(e);
            setError("Gagal membuat doa. Silakan coba lagi.");
        } finally {
            setIsLoading(false);
        }
    };
    
    const handleSaveGenerated = () => {
        if (generatedPrayer) {
            onSave({
                ...generatedPrayer,
                category: 'Dihasilkan AI',
                source: 'Gemini AI'
            });
            handleClose();
        }
    };
    
    const handleClose = () => {
        setTopic('');
        setGeneratedPrayer(null);
        setIsLoading(false);
        setError('');
        onClose();
    };

    if (!isOpen) return null;

    return (
         <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
            <div className="bg-white dark:bg-slate-800 rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col">
                <div className="p-6 border-b border-slate-200 dark:border-slate-700 flex justify-between items-start">
                    <div>
                        <h2 className="text-2xl font-bold text-slate-800 dark:text-slate-100">Buat Doa dengan AI</h2>
                        <p className="text-slate-600 dark:text-slate-400 mt-1">Tulis topik, dan biarkan Gemini membuatkan doa untuk Anda.</p>
                    </div>
                    <button onClick={handleClose} className="p-1 rounded-full text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors"><Icon name="x" className="w-6 h-6" /></button>
                </div>
                <div className="p-6 space-y-4 overflow-y-auto">
                    {!generatedPrayer && (
                        <div className="flex items-start space-x-2">
                            <input
                                type="text"
                                value={topic}
                                onChange={(e) => setTopic(e.target.value)}
                                placeholder="Cth: doa untuk kesabaran dalam menghadapi ujian"
                                className="flex-1 px-4 py-2 bg-slate-50 dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 text-slate-800 dark:text-slate-200 transition-colors"
                                disabled={isLoading}
                            />
                            <button onClick={handleGenerate} disabled={isLoading} className="px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 font-semibold transition-colors shadow-sm hover:shadow-md disabled:bg-slate-400 disabled:cursor-not-allowed flex items-center justify-center">
                                {isLoading ? <div className="animate-spin rounded-full h-5 w-5 border-b-2 border-white"></div> : 'Buat'}
                            </button>
                        </div>
                    )}
                    {error && <p className="text-red-500 text-sm">{error}</p>}

                    {generatedPrayer && (
                        <div className="p-4 bg-slate-50 dark:bg-slate-700/50 rounded-lg space-y-4 animate-fade-in">
                             <h3 className="text-xl font-bold text-slate-800 dark:text-slate-100">{generatedPrayer.title}</h3>
                             <p className="text-2xl text-right font-serif text-slate-900 dark:text-slate-100 leading-loose" lang="ar" dir="rtl">{generatedPrayer.arabic}</p>
                            <p className="text-md italic text-slate-500 dark:text-slate-400 leading-relaxed">{generatedPrayer.latin}</p>
                            <p className="text-md text-slate-700 dark:text-slate-300 leading-relaxed"><strong>Artinya:</strong> "{generatedPrayer.translation}"</p>
                        </div>
                    )}
                </div>
                 <div className="p-6 border-t border-slate-200 dark:border-slate-700 mt-auto flex justify-end space-x-3">
                    <button onClick={handleClose} className="px-5 py-2 bg-slate-200 dark:bg-slate-600 text-slate-800 dark:text-slate-200 rounded-lg hover:bg-slate-300 dark:hover:bg-slate-500 font-semibold transition-colors">Tutup</button>
                     {generatedPrayer && !isLoading && (
                        <button onClick={handleSaveGenerated} className="px-5 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 font-semibold transition-colors shadow-sm hover:shadow-md">
                            Tambah ke Koleksi
                        </button>
                     )}
                 </div>
            </div>
        </div>
    )
}


// -- KOMPONEN UTAMA APLIKASI --

export default function App() {
    const [prayers, setPrayers] = useState(() => {
        try {
            // Menggunakan Local Storage untuk menyimpan dan mengambil data doa
            const localData = localStorage.getItem('doaKoleksi');
            return localData ? JSON.parse(localData) : initialPrayerData;
        } catch (error) {
            console.error("Gagal memuat data dari localStorage:", error);
            return initialPrayerData;
        }
    });

    const [isDarkMode, setDarkMode] = useState(() => {
        if (typeof window !== 'undefined') {
             const savedMode = localStorage.getItem('temaAplikasi');
             return savedMode === 'dark' || (!savedMode && window.matchMedia('(prefers-color-scheme: dark)').matches);
        }
        return false;
    });

    useEffect(() => {
        if (isDarkMode) {
            document.documentElement.classList.add('dark');
            localStorage.setItem('temaAplikasi', 'dark');
        } else {
            document.documentElement.classList.remove('dark');
            localStorage.setItem('temaAplikasi', 'light');
        }
    }, [isDarkMode]);

    useEffect(() => {
        try {
            localStorage.setItem('doaKoleksi', JSON.stringify(prayers));
        } catch (error) {
            console.error("Gagal menyimpan data ke localStorage:", error);
        }
    }, [prayers]);

    const [searchTerm, setSearchTerm] = useState('');
    const [selectedCategory, setSelectedCategory] = useState('Semua');
    const [isSidebarOpen, setSidebarOpen] = useState(false);
    
    const [isModalOpen, setModalOpen] = useState(false);
    const [editingPrayer, setEditingPrayer] = useState(null);
    const [activePrayerId, setActivePrayerId] = useState(null);
    const importInputRef = useRef(null);

    // State untuk fitur Gemini
    const [isExplainModalOpen, setExplainModalOpen] = useState(false);
    const [explainPrayer, setExplainPrayer] = useState(null);
    const [explanation, setExplanation] = useState('');
    const [isExplanationLoading, setExplanationLoading] = useState(false);
    const [isGenerateModalOpen, setGenerateModalOpen] = useState(false);


    const categories = useMemo(() => ['Semua', ...[...new Set(prayers.map(p => p.category).filter(Boolean))].sort()], [prayers]);

    const filteredPrayers = useMemo(() => {
        return prayers.filter(prayer => {
            if (!prayer) return false;
            const matchesCategory = selectedCategory === 'Semua' || prayer.category === selectedCategory;
            const matchesSearch = searchTerm === '' || 
                (prayer.title && prayer.title.toLowerCase().includes(searchTerm.toLowerCase())) ||
                (prayer.latin && prayer.latin.toLowerCase().includes(searchTerm.toLowerCase())) ||
                (prayer.translation && prayer.translation.toLowerCase().includes(searchTerm.toLowerCase()));
            return matchesCategory && matchesSearch;
        });
    }, [prayers, searchTerm, selectedCategory]);
    
    // -- FUNGSI-FUNGSI PENGELOLAAN (CRUD, IMPORT/EXPORT) --

    const handleSavePrayer = (prayerData) => {
        if (prayerData.id) {
            setPrayers(prayers.map(p => p.id === prayerData.id ? prayerData : p));
        } else {
            const newPrayer = { ...prayerData, id: Date.now() };
            setPrayers(prevPrayers => [newPrayer, ...prevPrayers]);
        }
        setModalOpen(false);
        setEditingPrayer(null);
    };

    const handleAddClick = () => {
        setEditingPrayer(null);
        setModalOpen(true);
    };

    const handleEditClick = (prayer) => {
        setEditingPrayer(prayer);
        setModalOpen(true);
    };

    const handleDeleteClick = (prayerId) => {
        if (window.confirm('Apakah Anda yakin ingin menghapus doa ini?')) {
            setPrayers(prayers.filter(p => p.id !== prayerId));
        }
    };
    
    const handleExport = () => {
        const jsonString = `data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(prayers, null, 2))}`;
        const link = document.createElement('a');
        link.href = jsonString;
        link.download = `kumpulan_doa_${new Date().toISOString().split('T')[0]}.json`;
        link.click();
    };
    
    const handleImportClick = () => {
        importInputRef.current.click();
    };

    const handleImportFile = (event) => {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const importedPrayers = JSON.parse(e.target.result);
                    if (Array.isArray(importedPrayers) && importedPrayers.every(p => p.title && p.arabic)) {
                         if (window.confirm('Ini akan menggantikan semua data saat ini. Lanjutkan?')) {
                            setPrayers(importedPrayers);
                         }
                    } else {
                        alert('Format file JSON tidak valid.');
                    }
                } catch (error) {
                    alert('Gagal memproses file JSON.');
                }
            };
            reader.readAsText(file);
        }
        event.target.value = null; 
    };

    // -- FUNGSI-FUNGSI GEMINI API --
    const handleExplainClick = async (prayer) => {
        setExplainPrayer(prayer);
        setExplainModalOpen(true);
        setExplanationLoading(true);
        setExplanation('');

        const userQuery = `Sebagai seorang ahli dalam studi Islam, jelaskan doa "${prayer.title}" ini secara mendalam. Uraikan: 1. Konteks dan asal-usul doa ini (jika ada). 2. Keutamaan atau fadhilah mengamalkannya. 3. Waktu-waktu terbaik untuk membacanya. Gunakan format Markdown untuk jawaban Anda dengan judul, daftar, dan teks tebal.`;
        const apiKey = ""; // API key akan disediakan oleh environment
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

        const payload = {
            contents: [{ parts: [{ text: userQuery }] }],
        };
        
        try {
            let response;
            let retries = 3;
            let delay = 1000;
            while (retries > 0) {
                 response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (response.ok) break;

                retries--;
                if (retries === 0) throw new Error(`Permintaan API gagal dengan status ${response.status}`);
                await new Promise(resolve => setTimeout(resolve, delay));
                delay *= 2;
            }

            const result = await response.json();
            const text = result.candidates?.[0]?.content?.parts?.[0]?.text;
            if (text) {
                // Konversi Markdown sederhana ke HTML
                const htmlText = text
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    .replace(/\n/g, '<br />');
                setExplanation(htmlText);
            } else {
                setExplanation("Tidak dapat menerima penjelasan dari AI. Silakan coba lagi.");
            }
        } catch (error) {
            console.error(error);
            setExplanation("Maaf, terjadi galat saat mengambil penjelasan.");
        } finally {
            setExplanationLoading(false);
        }
    };


    return (
        <div className="bg-slate-50 dark:bg-slate-900 min-h-screen font-sans text-slate-800 dark:text-slate-200 antialiased">
            <div className="flex">
                <aside className={`fixed lg:static inset-y-0 left-0 bg-white dark:bg-slate-800 border-r border-slate-200 dark:border-slate-700 w-64 lg:w-72 transform ${isSidebarOpen ? 'translate-x-0 shadow-xl' : '-translate-x-full'} lg:translate-x-0 transition-transform duration-300 ease-in-out z-40 p-5 flex flex-col`}>
                    <div className="flex items-center space-x-2 mb-8">
                        <div className="w-8 h-8 bg-teal-500 rounded-lg flex items-center justify-center">
                           <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
                        </div>
                        <h2 className="text-xl font-bold text-slate-800 dark:text-slate-100">Doa Harian</h2>
                    </div>
                    
                    <div className="relative mb-6">
                        <input
                            type="text"
                            placeholder="Cari doa..."
                            value={searchTerm}
                            onChange={(e) => setSearchTerm(e.target.value)}
                            className="w-full pl-10 pr-4 py-2 bg-slate-100 dark:bg-slate-700 border border-transparent rounded-full focus:outline-none focus:ring-2 focus:ring-teal-500 focus:bg-white dark:focus:bg-slate-600 transition-colors"
                        />
                        <Icon name="search" className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400 dark:text-slate-500"/>
                    </div>
                    
                    <nav className="flex-1 overflow-y-auto -mr-3 pr-3">
                        <h3 className="text-sm font-semibold uppercase text-slate-500 dark:text-slate-400 mb-2 px-4">Kategori</h3>
                        <ul className="space-y-1">
                            {categories.map(category => (
                                <li key={category}>
                                    <a href="#"
                                        onClick={(e) => { e.preventDefault(); setSelectedCategory(category); setSidebarOpen(false); }}
                                        className={`flex items-center space-x-3 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${selectedCategory === category ? 'bg-teal-50 dark:bg-slate-700 text-teal-700 dark:text-teal-400' : 'text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700'}`}
                                    >
                                        <span className={`w-2 h-2 rounded-full ${selectedCategory === category ? 'bg-teal-500' : 'bg-slate-300 dark:bg-slate-500'}`}></span>
                                        <span>{category}</span>
                                    </a>
                                </li>
                            ))}
                        </ul>
                    </nav>
                </aside>
                
                <main className="flex-1 min-w-0">
                    <header className="sticky top-0 bg-white/90 dark:bg-slate-800/90 backdrop-blur-sm border-b border-slate-200 dark:border-slate-700 z-30">
                        <div className="flex items-center justify-between p-4">
                            <button onClick={() => setSidebarOpen(!isSidebarOpen)} className="lg:hidden p-2 rounded-md text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700">
                               <Icon name="menu" className="w-6 h-6"/>
                            </button>
                             <div className="flex-1 text-center lg:text-left ml-2 lg:ml-0">
                                <h1 className="text-2xl font-bold text-slate-900 dark:text-slate-100">Dasbor Doa</h1>
                                <p className="text-sm text-slate-500 dark:text-slate-400 hidden sm:block">Kelola, cari, dan baca koleksi doa harian Anda.</p>
                            </div>
                            <div className="flex items-center space-x-2">
                               <button onClick={() => setDarkMode(!isDarkMode)} className="p-2 rounded-lg text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors">
                                   {isDarkMode ? <Icon name="sun" className="w-5 h-5"/> : <Icon name="moon" className="w-5 h-5"/>}
                                </button>
                                <div className="hidden sm:block w-px h-6 bg-slate-200 dark:bg-slate-700"></div>
                                <button onClick={handleAddClick} className="flex items-center space-x-2 px-4 py-2 text-sm font-semibold bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors shadow-sm hover:shadow-md"><Icon name="plus" className="w-4 h-4"/><span>Doa Baru</span></button>
                            </div>
                        </div>
                    </header>
                    
                    <div className="p-4 sm:p-6 lg:p-8">
                        <div className="space-y-4">
                             <div className="flex flex-col sm:flex-row sm:items-center sm:justify-end gap-2 mb-4">
                                <button onClick={() => setGenerateModalOpen(true)} className="flex w-full sm:w-auto items-center justify-center space-x-2 px-3 py-2 text-sm font-semibold bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 text-teal-600 dark:text-teal-400 rounded-lg hover:border-teal-500 dark:hover:border-teal-500 transition-colors"><Icon name="sparkles" className="w-4 h-4"/><span>Buat Doa (AI)</span></button>
                                <input type="file" ref={importInputRef} onChange={handleImportFile} accept=".json" className="hidden"/>
                                <button onClick={handleImportClick} className="flex w-full sm:w-auto items-center justify-center space-x-2 px-3 py-2 text-sm font-semibold bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-200 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-600 transition-colors"><Icon name="upload" className="w-4 h-4"/><span>Impor</span></button>
                                <button onClick={handleExport} className="flex w-full sm:w-auto items-center justify-center space-x-2 px-3 py-2 text-sm font-semibold bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 text-slate-700 dark:text-slate-200 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-600 transition-colors"><Icon name="download" className="w-4 h-4"/><span>Ekspor</span></button>
                             </div>
                            {filteredPrayers.length > 0 ? (
                                filteredPrayers.map(prayer => (
                                    <PrayerCard
                                        key={prayer.id}
                                        prayer={prayer}
                                        onEdit={handleEditClick}
                                        onDelete={handleDeleteClick}
                                        onExplain={handleExplainClick}
                                        isActive={activePrayerId === prayer.id}
                                        onToggle={() => setActivePrayerId(activePrayerId === prayer.id ? null : prayer.id)}
                                    />
                                ))
                            ) : (
                                <div className="text-center py-20 px-6 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700">
                                    <Icon name="alert" className="w-12 h-12 mx-auto text-slate-400 dark:text-slate-500"/>
                                    <h3 className="mt-4 text-xl font-semibold text-slate-800 dark:text-slate-100">Doa Tidak Ditemukan</h3>
                                    <p className="mt-1 text-slate-500 dark:text-slate-400">Coba ganti kata kunci pencarian atau filter kategori Anda.</p>
                                </div>
                            )}
                        </div>
                    </div>
                </main>
            </div>
            
            <PrayerModal 
                isOpen={isModalOpen} 
                onClose={() => setModalOpen(false)} 
                onSave={handleSavePrayer}
                prayer={editingPrayer}
                categories={categories.filter(c => c !== 'Semua')}
            />
            <GeminiExplanationModal 
                isOpen={isExplainModalOpen}
                onClose={() => setExplainModalOpen(false)}
                prayer={explainPrayer}
                explanation={explanation}
                isLoading={isExplanationLoading}
            />
            <GeminiGenerateModal
                isOpen={isGenerateModalOpen}
                onClose={() => setGenerateModalOpen(false)}
                onSave={handleSavePrayer}
            />
        </div>
    );
}

